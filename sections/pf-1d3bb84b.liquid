{% comment %}
This file is auto-generated by PageFly. The content can be overridden when publish page in PageFly. Please do not update this file directly.
If you plan to remove PageFly, please see the guide in our help center first: https://help.pagefly.io/.
{% endcomment %}

{% liquid
  assign page_url = content_for_header | split:'"pageurl":"' | last | split:'"' | first | split: request.host | last | replace:'\/','/' | replace:'%20',' ' | replace:'\u0026','&'

  # Initialise variables for every parameter we care about
  assign location                  = ''
  assign no_station                = ''
  assign immediate_inventory       = ''
  assign timeslot                  = ''
  assign uuid                      = ''
  assign date                      = ''
  assign day_name                  = ''

  # Additional params
  assign additional_inventory      = ''
  assign additional_inventory_time = ''

  # Continue only if a query string actually exists in the URL
  if page_url contains '?'
    assign query_string = page_url | split:'?' | last
    assign qry_parts    = query_string | split:'&'

    # Iterate over each key=value pair, assigning values to their respective variables
    for part in qry_parts
      assign key_and_value = part | split:'='
      if key_and_value.size > 1
        case key_and_value[0]
          when 'location'
            assign location = key_and_value[1]
          when 'no_station'
            assign no_station = key_and_value[1]
          when 'immediate_inventory'
            assign immediate_inventory = key_and_value[1]
          when 'additional_inventory'
            assign additional_inventory = key_and_value[1]
          when 'additional_inventory_time'
            assign additional_inventory_time = key_and_value[1]
          when 'timeslot'
            assign timeslot = key_and_value[1]
          when 'uuid'
            assign uuid = key_and_value[1]
        endcase
      endif
    endfor
  endif

  # Derive date from uuid if not directly supplied
  if date == '' and uuid != ''
    for item in shop.metafields.custom.selected_dates.value
      if item.first == uuid
        assign date = item.last
        break
      endif
    endfor
  endif

  # Compute weekday name for later filtering
  if date != ''
    assign date_parts = date | split: '-'
    assign reformatted_date = date_parts[2] | append: '-' | append: date_parts[1] | append: '-' | append: date_parts[0]
    assign day_name = reformatted_date | date: "%A"
  endif
%}

<!-- URL Parameters (rendered for visibility – remove or style as needed) -->
<div id="url-params" style="font-weight:bold; margin-bottom:10px;">
  Location: {{ location }}<br>
  Date: {{ date }}<br>
  Immediate Inventory: {{ immediate_inventory }}<br>
  No Station: {{ no_station }}<br>
  UUID: {{ uuid }}
</div>

<style>.qty_list ul{margin:0;padding:0}.qty_list ul li{list-style-type:none}.progress_bar{margin-top:0!important}.add_to_cart[disabled]{cursor:not-allowed!important}.order_qty{float:right}</style><script>
	window.__pageflyProducts = window.__pageflyProducts || {};
	{% unless product.id == null %}window.__pageflyProducts["{{product.id}}"] = {
		id: {{ product.id | json }},
		handle: {{ product.handle | json }},
		title: {{ product.title | json }},
		type: {{ product.type | json }},
		url: {{ product.url | within: collection | json }},
		vendor: {{ product.vendor | json }},
		variants: {{ product.variants | json }},
		options: {{ product.options | json }},
		media: {{ product.media | json }},
		has_only_default_variant: {{ product.has_only_default_variant | json }},
		options_with_values: {{ product.options_with_values | json }},
		selected_variant: {{ product.selected_variant | json }},
		selected_or_first_available_variant: {{ product.selected_or_first_available_variant | json }},
		tags: {{ product.tags | json }},
		template_suffix: {{ product.template_suffix | json }},
		featured_image: {{ product.featured_image | json }},
		featured_media: {{ product.featured_media | json }},
		images: {{ product.images | json }},
		quantity: {% assign quantity = '' %}{% for variant in product.variants %}{% assign quantity = quantity | append: variant.id | append: ':' | append: variant.inventory_quantity | append: ',' %}{% endfor %}{% assign quantity = quantity | split: ','%}{{quantity | json }}
	};{% endunless %}
	</script><div data-pf-editor-version="legacy" class="sc-ktJcvw iZCSon __pf __pf_fSB2Dj3T" id="__pf"><div data-pf-type="Body" class="sc-fAGzVM kCwfYM pf-1_"><div data-pf-type="Layout" class="sc-bJBfJu gmOWvi pf-2_"><div data-section-id="pf-77fb" data-pf-type="Section" class="sc-dJjagV cQqdEF pf-3_ pf-color-scheme-1"><div style="--cw:1170px" class="sc-kCMLfs khbiTF"><div class="sc-hzhKNl fltMam pf-4_ product_list_portion pf-r pf-r-eh" style="--s-xs:15px" data-pf-type="Row"><div class="pf-c" style="--c-xs:12;--c-sm:12;--c-md:12;--c-lg:12"><div data-pf-type="Column" class="sc-bkSTSn hpQOMO pf-5_"><div style="--s-xs:8px;--s-sm:15px" data-pf-type="ProductList2" class="sc-bdOgOc sc-edLa-Dd fvoHdV iXixkM pf-6_ product_list"><div class="pf-slider pf-c-lt" style="--ss-xs:2;--ss-sm:2;--ss-md:4;--ss-lg:4" data-slider="{'navStyle':'none','maxHeight':true,'listLayout':{'all':0,'laptop':0,'tablet':0,'mobile':0},'slidesToShow':{'all':4,'laptop':4,'tablet':2,'mobile':2},'slidesToScroll':{'all':1,'laptop':4,'tablet':2,'mobile':2},'paginationStyle':'none','displayPartialItems':{'all':false,'laptop':false,'tablet':false,'mobile':false},'spacing':{'all':'30px','laptop':'30px','tablet':'30px','mobile':'16px'}}">{% assign defaultProduct = product %}
{% assign additional_inventory_ready = 'N' %}
{% if additional_inventory == 'Y' and additional_inventory_time == 'Y' %}
  {% assign comparedLocation = 'Additional Inventory' %}
  {% assign additional_inventory_ready = 'Y' %}
{% else %}
  {% assign comparedLocation = location %}
{% endif %}

{% paginate collections.all.products by 50 %}
{% for product in collections.all.products %}
{% assign product_index = forloop.index | minus: 1 %}
{% liquid
  assign productToShow = false
  assign qtyValue      = 0
  assign found         = false

  # Select appropriate inventory metafield
  if immediate_inventory == 'Y'
    assign customMetafield = product.metafields.custom.json
  else
    assign customMetafield = product.metafields.custom.preorder_inventory
  endif

  assign dateAndQtyJSON  = customMetafield | replace: '[', '' | replace: ']', '' | replace: '"', ''
  assign dateAndQtyArray = dateAndQtyJSON | split: ','

  for dateAndQtyVal in dateAndQtyArray
    assign cleanVal        = dateAndQtyVal | replace: '[', '' | replace: ']', '' | replace: '"', ''
    assign dateAndQtyValue = cleanVal | split: ':'
    assign dateValue       = dateAndQtyValue[1]
    if dateValue == date and comparedLocation == dateAndQtyValue[0]
      assign qtyValue = dateAndQtyValue[2]
      assign found    = true
    endif
  endfor

  assign dayList = product.metafields.custom.available_on
  for day in dayList.value
    if day == day_name and found == true
      assign productToShow = true
    endif
  endfor
%}
{% unless productToShow %}{% continue %}{% endunless %}
<div class="pf-slide pf-c"><script>
				window.__pageflyProducts = window.__pageflyProducts || {};
				window.__pageflyProducts["{{product.id}}"] = {
					id: {{product.id | json }},
					handle: {{product.handle | json }},
					title: {{product.title | json }},
					type: {{product.type | json }},
					url: {{product.url | within: collection  | json }},
					vendor: {{product.vendor | json }},
					variants: {{product.variants | json }},
					options: {{product.options | json }},
					media: {{product.media | json }},
					has_only_default_variant: {{product.has_only_default_variant | json }},
					options_with_values: {{product.options_with_values | json }},
					selected_variant: {{product.selected_variant | json }},
					selected_or_first_available_variant: {{product.selected_or_first_available_variant | json }},
					tags: {{product.tags | json }},
					template_suffix: {{product.template_suffix | json }},
					featured_image: {{product.featured_image | json }},
					featured_media: {{product.featured_media | json }},
					images: {{product.images | json }},
					quantity: {% assign quantity = '' %}{% for variant in product.variants %}{% assign quantity = quantity | append: variant.id | append: ':' | append: variant.inventory_quantity | append: ',' %}{% endfor %}{% assign quantity = quantity | split: ','%}{{quantity | json }}

				};</script><div data-product-id="{{ product.id }}" data-pf-type="ProductBox" class="sc-enkJyZ dMMyzv pf-7_ product_details">{% if product != null %}{% form "product", product, data-productid: product.id, class: "pf-product-form" %}<div class="sc-hzhKNl fltMam pf-8_ product_row pf-r pf-r-eh" style="--s-xs:0px" data-pf-type="Row"><div class="pf-c" style="--c-xs:12;--c-sm:12;--c-md:12;--c-lg:12"><div data-pf-type="Column" class="sc-bkSTSn hpQOMO pf-9_"><div data-product-id="{{ product.id }}" data-media-id="{% liquid
    assign min = 10000000000
    assign max = 99999999999
    assign diff = max | minus: min
    assign number = "now" | date: "%N" | modulo: diff | plus: min
  %}{{number}}" data-pf-type="ProductMedia2" class="sc-fzQBUN iDVwIH pf-10_">
                      {% assign media = product.media %}
                      {% assign featured_media = product.featured_media %}
                      {% assign _product = product %}
                      {% assign first_3d_model = product.media | where: "media_type", "model" | first %}
                  <div class="sc-hpGmyb vtAED   pf-lg-hide-list pf-md-hide-list pf-sm-hide-list pf-xs-hide-list product-media2-inner product-media-loading"><div class="sc-cDvRoM lcnHtR pmw pf-main-media-wrapper"><div data-pf-type="MediaMain" class="sc-etlBSa fiCOST pf-11_ pf-main-media" data-href="{{ product.url }}" data-action="url"><div class="sc-biziTF jejeLd">{% if media.size == 0 %}<div class="pf-media-slider scrollfix">{{ 'image' | placeholder_svg_tag: 'placeholder-svg' }}</div>{% else %}<div class="pf-media-slider scrollfix" data-id="slider-8e42d645-e9d5-41a1-85d9-e34f4f1877b1">{% for media_item in media %}<div class="pf-slide-main-media" data-media-type="{{ media_item.media_type }}" data-media-id="{{ media_item.id }}">{% case media_item.media_type %}
                  {% when 'model' %}<div class="pf-media-wrapper" style="--r-lg:{{ 1 | divided_by: media_item.preview_image.aspect_ratio | times: 100 }}%">{{ media_item | media_tag }}<div class="pf-mask"><span><svg width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg"><path opacity="0.6" d="M14.1301 3.27971L9.00008 0.319707C8.69604 0.144171 8.35115 0.0517578 8.00008 0.0517578C7.649 0.0517578 7.30411 0.144171 7.00008 0.319707L1.88008 3.31971C1.5719 3.49759 1.31675 3.75447 1.14097 4.06385C0.965185 4.37323 0.875124 4.72391 0.880077 5.07971V10.9997C0.875124 11.3555 0.965185 11.7062 1.14097 12.0156C1.31675 12.3249 1.5719 12.5818 1.88008 12.7597L7.00008 15.7597C7.30411 15.9352 7.649 16.0277 8.00008 16.0277C8.35115 16.0277 8.69604 15.9352 9.00008 15.7597L14.1201 12.7597C14.4283 12.5818 14.6834 12.3249 14.8592 12.0156C15.035 11.7062 15.125 11.3555 15.1201 10.9997V4.99971C15.119 4.65165 15.0271 4.30991 14.8535 4.00825C14.6798 3.7066 14.4305 3.45547 14.1301 3.27971ZM7.73008 14.3797L2.61008 11.3797C2.54095 11.34 2.48167 11.2852 2.43666 11.2194C2.39164 11.1536 2.36205 11.0785 2.35008 10.9997V4.99971C2.3504 4.90601 2.37556 4.81407 2.42299 4.73327C2.47042 4.65246 2.53843 4.58567 2.62008 4.53971L7.74008 1.53971C7.82065 1.49319 7.91204 1.4687 8.00508 1.4687C8.09811 1.4687 8.18951 1.49319 8.27008 1.53971L13.3901 4.53971L8.67008 7.21971C8.45972 7.33976 8.28614 7.51498 8.16806 7.72646C8.04999 7.93793 7.9919 8.17764 8.00008 8.41971V14.4197C7.91475 14.4413 7.8254 14.4413 7.74008 14.4197L7.73008 14.3797Z" fill="black"></path></svg></span></div></div>{% when 'external_video' %}<div class="pf-media-wrapper" data-video-host="{{ media_item.host }}" style="--r-lg:{{ 1 | divided_by: media_item.preview_image.aspect_ratio | times: 100 }}%">{{ media_item | media_tag }}<div class="pf-mask-iframe" data-play="false"></div></div>{% when 'video' %}<div class="pf-media-wrapper" style="--r-lg:{{ 1 | divided_by: media_item.preview_image.aspect_ratio | times: 100 }}%">{{ media_item | media_tag: image_size: '1080x' }}</div>{% else %}<img loading="lazy" class="sc-eFRbCa byOIro active" data-action="1" alt="{{ media_item.alt }}" width="{{ media_item.width }}" height="{{ media_item.height }}" src="{{ media_item | image_url }}"/>{% endcase %}</div>{% endfor %} </div>{% endif %}</div></div></div><div class="sc-cYYudL bioLUo pf-12_ pf-list-media pf-hide pf-sm-hide pf-md-hide pf-lg-hide" data-pf-type="MediaList2"><div class="pf-media-slider scrollfix " style="--dpi-xs:0%;--gap-xs:10px" data-id="slider-42d645e9-d5d1-4105-99e3-4f4f1877b133">{% for media_item in media %}
              {% assign media_type = media_item.media_type %}<div class="sc-kdIger iumixj pf-13_ pf-slide-list-media" data-img-id="{{ media_item.id }}" data-media-type="{{ media_item.media_type }}" data-pf-type="MediaListItem2"><img src="{{ media_item | img_url: "xundefined", scale: 2 }}" alt="{{ media_item.alt }}" loading="lazy"/>{% case media_type %}
            {% when 'model' %}<span class="sc-inyWwX bHbGXm"><svg width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg"><path opacity="0.6" d="M14.1301 3.27971L9.00008 0.319707C8.69604 0.144171 8.35115 0.0517578 8.00008 0.0517578C7.649 0.0517578 7.30411 0.144171 7.00008 0.319707L1.88008 3.31971C1.5719 3.49759 1.31675 3.75447 1.14097 4.06385C0.965185 4.37323 0.875124 4.72391 0.880077 5.07971V10.9997C0.875124 11.3555 0.965185 11.7062 1.14097 12.0156C1.31675 12.3249 1.5719 12.5818 1.88008 12.7597L7.00008 15.7597C7.30411 15.9352 7.649 16.0277 8.00008 16.0277C8.35115 16.0277 8.69604 15.9352 9.00008 15.7597L14.1201 12.7597C14.4283 12.5818 14.6834 12.3249 14.8592 12.0156C15.035 11.7062 15.125 11.3555 15.1201 10.9997V4.99971C15.119 4.65165 15.0271 4.30991 14.8535 4.00825C14.6798 3.7066 14.4305 3.45547 14.1301 3.27971ZM7.73008 14.3797L2.61008 11.3797C2.54095 11.34 2.48167 11.2852 2.43666 11.2194C2.39164 11.1536 2.36205 11.0785 2.35008 10.9997V4.99971C2.3504 4.90601 2.37556 4.81407 2.42299 4.73327C2.47042 4.65246 2.53843 4.58567 2.62008 4.53971L7.74008 1.53971C7.82065 1.49319 7.91204 1.4687 8.00508 1.4687C8.09811 1.4687 8.18951 1.49319 8.27008 1.53971L13.3901 4.53971L8.67008 7.21971C8.45972 7.33976 8.28614 7.51498 8.16806 7.72646C8.04999 7.93793 7.9919 8.17764 8.00008 8.41971V14.4197C7.91475 14.4413 7.8254 14.4413 7.74008 14.4197L7.73008 14.3797Z" fill="black"></path></svg></span>{% when 'external_video' or 'video' %}<span class="sc-inyWwX bHbGXm"><svg width="11" height="14" viewBox="0 0 11 14" fill="none" xmlns="http://www.w3.org/2000/svg"><path opacity="0.6" d="M1.71795 0.719814C1.56631 0.627985 1.39299 0.578117 1.21573 0.57532C1.03847 0.572523 0.863662 0.616896 0.7092 0.703896C0.554738 0.790895 0.42618 0.917392 0.336696 1.07043C0.247212 1.22346 0.200019 1.39754 0.199951 1.57481V12.3108C0.199976 12.4926 0.249526 12.6708 0.343274 12.8265C0.437022 12.9822 0.571425 13.1094 0.732038 13.1945C0.89265 13.2795 1.0734 13.3191 1.25486 13.3092C1.43632 13.2992 1.61163 13.24 1.76195 13.1378L10.112 7.46081C10.2504 7.36662 10.363 7.23915 10.4394 7.09011C10.5158 6.94107 10.5536 6.77523 10.5492 6.6078C10.5448 6.44038 10.4985 6.27673 10.4144 6.13189C10.3303 5.98704 10.2112 5.86564 10.068 5.77881L1.71795 0.718814V0.719814Z" fill="black"></path></svg></span>{% endcase %}</div>{% endfor %}</div></div></div></div><h3 data-product-type="title" data-product-id="{{ product.id }}" data-href="{{ product.url | within: collection }}?location={{ location }}&no_station={{ no_station }}&additional_inventory_time={{ additional_inventory_time }}&immediate_inventory={{ immediate_inventory }}&timeslot={{ timeslot }}&day={{ day_name }}&uuid={{ uuid }}" data-pf-type="ProductTitle" class="sc-jkTopv sc-ciQpcn ivnYkW iDxSKP pf-15_ pf-heading-1-h3">{{ product.title }}</h3><div data-product-id="{{ product.id }}" data-pf-type="ProductMetafield" class="sc-eONOlN glJLTJ pf-16_ qty_portion"><span data-pf-type="MetafieldLabel" class="sc-bStdFM ktWYrb pf-17_">Verfügbare Anzahl:</span>
<span data-pf-type="MetafieldValue" class="sc-djVWQC byBDcH pf-18_ qty_value">{{ qtyValue }}</span></div><div data-product-id="{{ product.id }}" data-hidespinner="true" data-pf-type="ProductQuantity" class="sc-jgyWMn dXMhSl pf-19_ order_qty"><button class="sc-la-DjoC SsAZs pf-20_ pf-button-1 pf-no-border" data-quantity-action="decrease" type="button" aria-label="Decrease quantity for {{ product.title }}" data-pf-type="QuantityButton"><svg style="--h-xs:30" viewBox="0 0 448 512" fill="currentColor"><path d="M432 256c0 17.7-14.3 32-32 32L48 288c-17.7 0-32-14.3-32-32s14.3-32 32-32l352 0c17.7 0 32 14.3 32 32z"></path></svg></button><input min="1" max="{{ qtyValue }}" type="number" data-hidespinner="true" name="quantity" aria-label="Quantity for {{ product.title }}" data-pf-type="QuantityField" id="05d9e34f" class="sc-harTYt xbIkq pf-21_" value="1"/><button class="sc-la-DjoC SsAZs pf-22_ pf-button-1 pf-no-border" data-quantity-action="increase" type="button" aria-label="Increase quantity for {{ product.title }}" data-pf-type="QuantityButton"><svg style="--h-xs:30" viewBox="0 0 448 512" fill="currentColor"><path d="M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32V224H48c-17.7 0-32 14.3-32 32s14.3 32 32 32H192V432c0 17.7 14.3 32 32 32s32-14.3 32-32V288H400c17.7 0 32-14.3 32-32s-14.3-32-32-32H256V80z"></path></svg></button></div><div data-show-button="true" data-more="" data-less="" data-product-type="content" data-product-id="{{ product.id }}" data-pf-type="ProductDescription" class="sc-jkTopv sc-fIGKkh ivnYkW kwSmup pf-23_">{{ product.content }}</div><div data-pf-type="ProductPrice2" class="sc-IqJhK iDIZgg pf-24_ pf-text-1"><div data-product-type="price" data-product-id="{{ product.id }}" data-product-price="true" data-pf-type="ProductPrice2Item" class="sc-eiQrVR tpBxD pf-25_ pf-text-1">{{ product.variants[0].price | money }}</div></div><input type="hidden" name="properties[max_quantity]" value="{{ qtyValue }}"><input type="hidden" name="properties[location]" value="{{ location }}"><input type="hidden" name="properties[date]" value="{{ date }}"><input type="hidden" name="properties[day]" value="{{ day_name }}"><input type="hidden" name="properties[no_station]" value="{{ no_station }}"><input type="hidden" name="properties[additional_inventory]" value="{{ additional_inventory_ready }}"><input type="hidden" name="properties[immediate_inventory]" value="{{ immediate_inventory }}"><input type="hidden" name="properties[timeslot]" value="{{ timeslot }}"><input type="hidden" name="order_date" value="{{ date }}"><input type="hidden" name="location" value="{{ location }}"><input type="hidden" name="day" value="{{ day_name }}"><button data-product-id="{{ product.id }}" data-checkout="same" data-soldout="Ausverkauft" data-adding="..." data-added="Danke!" name="add" type="button" data-pf-type="ProductATC2" class="sc-xwvkV jQxkTj pf-27_ pf-button-1 add_to_cart">In den Warenkorb</button></div></div></div>{% endform %}{% endif %}</div></div>{% endfor %}{% endpaginate %}{% assign product = defaultProduct %}<button type="button" aria-label="Previous" style="visibility:hidden" class="pf-slider-prev none"></button><button type="button" aria-label="Next" style="visibility:hidden" class="pf-slider-next none"></button></div></div></div></div></div></div></div></div></div></div><script>
    !function(){
      window.__pagefly_page_setting__ = {"pageTitle":"2 - order_menue - 2024-10-09 19:23:51","pageType":"page","pageId":"1d3bb84b-8dc5-4bfc-9717-53f73fe37b0b","lazyLoad":false,"forceByPassGoogleLightHouse":false,"imageLazyLoad":true,"nativeImageLazyLoad":true,"useThemeJQ":false,"sectionRootType":"Body","trackingIDs":[]};
      window.__pagefly_setting__&&(window.__pagefly_setting2__=window.__pagefly_setting__),window.__pagefly_setting__={"baseURL":"https://apps.pagefly.io","analyticsURL":"https://analytics.pagefly.io","isBackend":false,"cdnURL":"https://cdn.pagefly.io","pageflyVersion":"4.23.6.0","shopDomain":"sushi2024.myshopify.com","elementData":{"pf-11_":{"hoverAction":0,"onHover":0,"clickAction":1,"navStyle":"none","paginationStyle":"none","slidesToShow":{"all":1,"laptop":1,"tablet":1,"mobile":1},"slidesToScroll":{"all":1,"laptop":1,"tablet":1,"mobile":1},"id":"8e42d645-e9d5-41a1-85d9-e34f4f1877b1","_type":"MediaMain"},"pf-12_":{"slidesToShow":{"all":5,"laptop":5,"tablet":5,"mobile":5},"slidesToScroll":{"all":1,"laptop":1,"tablet":1,"mobile":1},"displayPartialItems":{"all":false,"laptop":false,"tablet":false,"mobile":false},"navStyle":"none","listLayout":{"all":1,"laptop":1,"tablet":1,"mobile":1},"id":"42d645e9-d5d1-4105-99e3-4f4f1877b133","_type":"MediaList2"},"pf-14_":{"applyCondition":false,"collectionSource":"all","collectionIds":[],"tags":"","id":"45e9d5d1-a105-49e3-8f4f-1877b133f71d","_type":"ProductBadge"},"pf-10_":{"listPosition":{"all":2,"laptop":2,"tablet":2,"mobile":2},"hoverAction":0,"onHover":0,"clickAction":0,"imageSource":"featured","id":"068e42d6-45e9-45d1-a105-d9e34f4f1877","_type":"ProductMedia2"},"pf-27_":{"iconPos":"left","id":"33f71d3b-b84b-4dc5-8bfc-971753f73fe3","_type":"ProductATC2"}},"shopifyProxyPath":"/apps/pagefly"},window.__pagefly_setting2__&&(window.__pagefly_setting__=function _(d,b){let c={...d||{}};for(let a of Object.keys(b))b[a]instanceof Object&&(Array.isArray(b[a])&&c[a]?Object.assign(b[a],[...b[a],...c[a]]):Object.assign(b[a],_(c[a],b[a])));return Object.assign(c||{},b),c}(__pagefly_setting2__,__pagefly_setting__),delete window.__pagefly_setting2__),window.__pagefly_setting__.moneyFormat={{shop.money_format|json}}}();
    </script><script>if (window.jQuery) {
  let $ = window.jQuery;

  $('.order_qty').each(function () {
    var btn = $(this).siblings('.add_to_cart');

    if (parseInt($(this).find('input').val(), 10) > parseInt($(this).find('input').attr('max'), 10)) {

      btn.html(btn.data('soldout'));

      var element = btn;
      $.each(btn[0].attributes, function () {
        if (this.name != "class")
          element.removeAttr(this.name);
      });

      btn.attr('disabled', true);
      btn.prop('disabled', true);

      $(this).remove();
    }
  });
}

window.onload = function () {
  if (window.jQuery) {
    let $ = window.jQuery;

    $(".add_to_cart").click(function (e) {
      // e.preventDefault();
      // e.stopPropagation();
      var btn = $(this);
      var btnthis = this;

      var qty = parseInt(btn.siblings('.order_qty').find('input').val(), 10);
      var max_qty = parseInt(btn.siblings('.order_qty').find('input').attr('max'), 10);

      if (qty >= max_qty) {

        var newElement = $("<span></span>");

        $.each(btnthis.attributes, function () {
          if (this.specified) {
            newElement.attr(this.name, this.value);
          }
        });

        newElement.html(btn.data('soldout'));
        newElement.attr('disabled', true);
        newElement.prop('disabled', true);

        btn.siblings('.order_qty').remove();
        btn.replaceWith(newElement);
      }
    });

    $('button[data-quantity-action]').click(function (e) {
      e.preventDefault();
      var $button = $(this);
      var $input = $button.siblings('input[name="quantity"]');
      var oldValue = parseInt($input.val(), 10);
      var newVal = oldValue;

      if ($button.data('quantity-action') === 'increase') {
        newVal = oldValue + 1;
      } else if ($button.data('quantity-action') === 'decrease') {
        newVal = Math.max(oldValue - 1, 1); // Ensure newVal doesn't go below 1
      }

      // $input.val(newVal).trigger('change'); // Update and trigger change to handle states
      updateButtonStates2($input, newVal);
    });

    // Handle key up and paste events for the input
    $('input[name="quantity"]').on('keyup paste', function (e) {
      e.preventDefault();
      var $input = $(this);
      setTimeout(function () { // Timeout for paste event to get the pasted value
        var value = parseInt($input.val(), 10) || 1; // Default to 1 if input is not a number
        var min = parseInt($input.attr('min'), 10) || 1;
        var max = parseInt($input.attr('max'), 10);

        // Correct the value if it's outside the min/max range
        if (max && value > max) {
          $input.val(max);
        } else if (value < min) {
          $input.val(min);
        } else {
          $input.val(value);
        }

        updateButtonStates($input); // Update button states
      }, 0);
    }).change(function () {
      updateButtonStates($(this)); // Also update button states when input changes
    });

    // Initial update for button states
    $('input[name="quantity"]').each(function () {
      updateButtonStates($(this));
    });



    function updateButtonStates($input) {
      var min = parseInt($input.attr('min'), 10) || 1; // Default minimum to 1 if not set
      var max = parseInt($input.attr('max'), 10); // Max can be undefined
      var value = parseInt($input.val(), 10);

      console.log(value);

      $input.siblings('button[data-quantity-action="decrease"]').prop('disabled', value <= min);
      $input.siblings('button[data-quantity-action="increase"]').prop('disabled', value >= max);
    }

    function updateButtonStates2($input, value) {
      var min = parseInt($input.attr('min'), 10) || 1; // Default minimum to 1 if not set
      var max = parseInt($input.attr('max'), 10); // Max can be undefined
      $input.siblings('button[data-quantity-action="decrease"]').prop('disabled', value <= min);
      $input.siblings('button[data-quantity-action="increase"]').prop('disabled', value >= max);
    }

  }
}</script>
{% schema %}
{
  "name": "PageFly Page 1d3bb84b",
  "settings": [
    {
      "type": "paragraph",
      "content": "For full configuration, [visit PageFly Editor](https://sushi2024.myshopify.com/admin/apps/pagefly/editor?id=1d3bb84b-8dc5-4bfc-9717-53f73fe37b0b&type=page)."
    }
  ],
  "blocks": [
    {
      "type": "@app"
    }
  ]
}
{% endschema %}