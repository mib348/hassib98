first make changes in the frontend


top

{% assign days_in_english = "Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday" | split: "," %}
{% assign current_day_index = 'now' | date: "%w" | plus: 0 %}
{% assign current_day_name_in_english = days_in_english[current_day_index] %}


{% assign page_url = content_for_header | split:'"pageurl":"' | last | split:'"' | first | split: request.host | last | replace:'\/','/' | replace:'%20',' ' | replace:'\u0026','&'  %}
{% assign param = blank %}

{%- for i in (1..1) -%}

  {%- unless page_url contains "?" -%}{% break %}{%- endunless -%}
  {%- assign query_string = page_url | split:'?' | last -%}
  {%- assign qry_parts= query_string | split:'&' -%}

  {%- for part in qry_parts -%}
    {%- assign key_and_value = part | split:'=' -%}
    {%- if key_and_value.size > 1 -%}
      {% if key_and_value[0] == 'date' %}
        {% assign date = key_and_value[1] %}
      {% endif %}
      {% if key_and_value[0] == 'location' %}
        {% assign location = key_and_value[1] %}
      {% endif %}
    {%- endif -%}
  {%- endfor -%}
{%- endfor -%}








product


{% assign defaultProduct = product %}
{% paginate collections.all.products by 50 %}
    {% for product in collections.all.products %}
        {% assign dateAndQtyList = product.metafields.custom.date_and_quantity %}
        {% assign productToShow = false %} 

        {% for dateAndQty in dateAndQtyList.value %} 
            {% assign dateAndQtyArray = dateAndQty | split: ':' %} 
            {% assign dateValue = dateAndQtyArray[0] %} 
            {% if dateValue == date %} 
                {% assign qtyValue = dateAndQtyArray[1] %} 
                {% assign productToShow = true %} 
            {% endif %} 
        {% endfor %}

        {% assign dayList = product.metafields.custom.available_on %}
        {% for day in dayList.value %}
            {% if day == current_day_name_in_english %} 
                {% assign productToShow = true %} 
                {% comment %} {% assign qtyValue = product.variants[0].inventory_quantity %}  {% endcomment %}
            {% endif %}
        {% endfor %} 

        {% if productToShow %}



product goes here



        {% endif %}  

    {% endfor %}
{% endpaginate %}





qtyValue
product.metafields.custom['date_and_quantity']|metafield_tag


remove {% if product.metafields.custom['date_and_quantity'] != null %}
  remove endif



remove data-variants-continue ---------- max {{ qtyValue }}






before endpaginate button

<input type="hidden" name="properties[location]" value="{{ location }}"><input type="hidden" name="properties[date]" value="{{ date }}"><input type="hidden" name="properties[day]" value="{{ current_day_name_in_english }}"><input type="hidden" name="order_date" value="{{ date }}"><input type="hidden" name="location" value="{{ location }}"><input type="hidden" name="day" value="{{ current_day_name_in_english }}">